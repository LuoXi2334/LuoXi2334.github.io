---
title: 指针初步
date: 2022-12-10 22:00:00
description: 洛希的十二月份笔记内容
categories: c语言
tag: C语言
swiper_index: 1 
top_group_index: 1 
---

# 指针

## ①地址和变量

### （1）地址

在C语言中，`scanf`函数需要使用地址作为参数，因为它需要在内存中修改值。变量的地址就是指向该变量的内存位置的`指针`，所以如果要在函数内部修改变量的值，就必须使用取址符`&`来获取变量的地址。

`地址指的是在计算机内存中存储数据的位置。`在我们日常生活中，我们可能会收到一份信件，这份信件会有一个指定的地址，用于确定信件发送到哪里。在计算机内存中，每个数据都有一个唯一的地址，用于确定它在内存中的位置。

### （2）变量

`变量是在计算机程序中用来存储数据的一种容器。`在我们日常生活中，我们可能会用一个背包来装东西，我们可以随时将东西放入背包或者从背包中取出东西。在计算机程序中，变量也可以用来存储数据，并且可以随时将数据存入变量或者从变量中取出数据。

地址和变量之间的关系：`当我们使用变量来存储数据时，计算机会在内存中的特定地址来存储这些数据。`这样，当我们需要使用这些数据时，就可以通过变量来访问数据所在的内存地址，从而取出数据。

## ②指针和指针变量

### （1）指针和地址

通过上面对于地址和变量的解释，我们提到了`"地址"`这一个概念，而指针与它有着密切的联系。

`指针存储的是某个数据在内存中的地址`，也就是说，指针实际上就是某个数据在内存中的地址。这就像在旅游时，一个人指着某个方向告诉你去哪里，这个方向就是某个地方的地址。

### （2）定义指针变量

```c
类型名 *指针变量名
char *pa;//定义一个指向字符型的指针变量
int *pb;//定义一个指向类型的指针变量
```

## ③取地址运算符和取值运算符(间接运算符)

### （1）取地址运算符

如果需要获取某个变量的地址，可以使用取地址运算符(&)：

```c
char *pa = &a;
int *pb = &f;
```

### （2）取值运算符(间接运算符)

如果需要访问指针变量指向的数据，可以使用取值运算符(*):

```c
printf("%c, %d\n", *pa, *pb);
```

我们不难发现，在我们使用取值运算符的时候再回看前面的定义指针变量时候用的符号都是`"*"`。这很明显是一种符号的重用。但是在不同的地方它肯定是有不同的含义的，`在定义的时候，它定义的是指针变量。再其他地方的时候，它指的是取指针变量指向的那个变量的值。`

**直接访问变量的值我们称为`直接访问`**

```c
printf("%d",a);//这里就是直接访问a的值
```

**通过访问指针存放的地址指向的那个值我们称之为`间接访问`**

```c
printf("%c, %d\n", *pa);//这里就是间接访问a的值
```

注：所以根据以上的例子，`取值运算符有时候又被称为间接运算符`。

对于以上的内容，我将用有一串代码来帮助理解。

```c
#include <stdio.h>
int main()
{
    char m = 'A';
    int n = 114514;
    char* pa = &m;
    int* pb = &n;
    printf("m = %c\n", *pa);
    printf("n = %d\n", *pb);
    *pa = 'B';
    *pb += 1805296;//表示先加让地址b内的变量n先加1805296，再让n=这个加后的值，即是n = n + 1805296 
    printf("现在m = %c\n", *pa);
    printf("现在n = %d\n", *pb);
    return 0;
}
```

对于以上的代码输出的结果如下所示

![image-20221210224807297](https://luoxi2334.oss-cn-shanghai.aliyuncs.com/luoxi-picture/202212102248384.png)

一般来说指针定义的地址变量一般只占用四个字节的内存空间，但是真的是这样吗？我们应该如何将它计算出来了，这个时候就可以用到sizeof函数来进行计算下指针定义的地址变量是否占用四个字节。

```c
#include <stdio.h>
int main()
{
    char* pa ;
    printf("pa占用内存为%d个字节\n",sizeof (pa));
}
```

我们分别测试两个编译器来看看结果吧！

**vscode** 

![image-20221210225503070](https://luoxi2334.oss-cn-shanghai.aliyuncs.com/luoxi-picture/202212102255131.png)

**vs2019**

![image-20221210225515471](https://luoxi2334.oss-cn-shanghai.aliyuncs.com/luoxi-picture/202212102255530.png)

我们发现不同的编译器的指针变量占用的内存空间不一样，在vscode里面是8个字节，而在vs2019中却是4个字节，但是一般的编译器都是占用4个字节

还有就是我们上面代码打印的地址指向的那个变量，接下来我们来试着把指针的地址打印出来，会出现什么样的结果呢？

```c
#include <stdio.h>
int main()
{
    char* pa;
    int* pb;
    printf("pa = %p\n", pa);//%p的作用是打印变量地址
    printf("pb = %p\n", pb);
    return 0;
}
```

最后打印出来的结果就是一个十六进制的地址，结果如下

![image-20221210230750524](https://luoxi2334.oss-cn-shanghai.aliyuncs.com/luoxi-picture/202212102307588.png)

## ④避免访问未初始化的指针

比如以下的代码就是十分的危险的

```c
#include <stdio.h>
int main ()
{
int *a;
*a = 123;
return 0;
}
```

这段代码中有一个严重的错误。它将一个未初始化的指针指向一个整数，并尝试对这个整数进行赋值。这种操作是不安全的，可能会导致程序崩溃或产生未定义的行为。

